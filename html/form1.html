<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  

  <script>
   var offLightState = function (light) {
     this.light = light
   }
   offLightState.prototype.buttonWasPressed = function () {
     console.log("弱光");
     this.light.setState(this.light.weakLightState)
   }
   var weakLightState = function (light) {
     this.light = light
   }
   weakLightState.prototype.buttonWasPressed = function () {
     console.log("强光");
     this.light.setState(this.light.strongLightState)
   }
   var strongLightState = function (light) {
     this.light = light
   }
   strongLightState.prototype.buttonWasPressed = function () {
     console.log("关灯");
     this.light.setState(this.light.offLightState)
   }

   var light = function () {
     console.log(this);
     this.offLightState = new offLightState(this)
     this.weakLightState = new weakLightState(this)
     this.strongLightState = new strongLightState(this)
     this.button = null
   }
   light.prototype.init = function () {
     let button = document.createElement('button')
     self = this
     this.button = document.body.appendChild(button)
     this.button.textContent = '开关'
     this.currState = this.offLightState
     this.button.onclick = function () {
       self.currState.buttonWasPressed()
     }
   }
   light.prototype.setState = function(newState) {
     this.currState = newState
   }

   var light1 = new light()
   light1.init()
  </script>
</body>
</html>